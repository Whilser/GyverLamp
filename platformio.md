## Как собрать проект с помощью platformio

Arduino IDE настолько же неудобна в использовании на сколько и популярна. Это воистину "школьная" среда для полных новичков, дабы не пугать людей обилием кнопок.

Platformio не является средой разработки как таковой, это по сути экосистема для разработки под embeded.

В чем плюсы platformio для новичка даже по сравнению с Arduino IDE? Platformio использует файл конфигурации для каждого своего проекта, в котором полностью описано из чего состоит проект, какую платформу он использует, тип микроконтроллера и платы на его основе, а также ссылки на все зависимые библиотеки.
По сути это позволяет собрать проект "одной кнопкой", разработчики проекта уже все описали для вас всю его конфигурацию. Не требуется скачивать и устанавливать сторонние библиотеки, обновлять их, выбирать рабочую версию и т.п. Кроме того platformio позволяет описать несколько вариантов сборки одного проекта в разных конфигурациях, например для разного типа плат, облегченную рабочую и debug-версию прошивки, версии с разной конфигурацией билиотек и параметров сборки. Нужные конфигурации можно и добавить самому, не исправляя каждый раз опции в файлах самого проекта, которые будут каждый раз сбрасываться при обновлении репозитория.

Для сборки gywer lamp под platformio понадобится следующее:

Установить [IDE Visual Studio Code](https://code.visualstudio.com/), и в качестве плагина к ней установить [Platformio](https://platformio.org/). О том как это сделать можно найти массу роликов на youtube, например [этот](https://www.youtube.com/watch?v=NSljt17mg74). Сделать это ничуть не сложнее чем установить Arduino IDE и потом мучаться в ней с установкой ядра ESP8266 и кучи сторонних библиотек.

После установки VSCode, нужно поставить расширение русификатор и расширение Platformio, все зависимости среда скачает и установит сама. 

 * Скачиваем проект GywerLamp в виде zip, либо клонируем Git репозиторий
 * Открываем папку проекта в проводнике, заходим в каталог gyverlamp, где находятся исходники. Находим файл config.h.default и копируем его под новым именем config.h в этот же каталог. Это будет файл с вашими конкретными настройками параметров прошивки, он не будет перезаписываться при обовлении git-репозитория. 
 * В файле config.h меняем параметры часового пояса, размер матрицы и прочие опции, если необходимо
 * Открываем папку проекта в VSCode
 * Что бы собрать прошивку, можно воспользоваться кнопками в нижней статусной строке:
   - PlatformIO:Build - собрать прошивку
   - PlatformIO:Upload - загрузить прошивку через USB в плату esp8666
Platformio сам скачает необходимые бибиотеки для сборки проекта.

Также можно открыть терминал с помощью клавишь Ctrl+Shit+` и воспользоваться расширенными командами для сборки проекта.

 - **pio run** - собрать проект по умолчанию
 - **pio run -e debug** - собрать таргет debug, будет собрана прошивка с выводом отладочных сообщений через serial интерфейс
 - **pio run -t upload** - собрать и прошить проект по умолчанию
 - **pio run -e debug -t upload** - собрать и прошить debug версию
 - **pio devide monitor -e debug** - запустить serial-монитор для просмотра сообщений, выдаваемых контроллером
 
 После первой прошивки дальнейшие обновления можно заливать в контроллер по воздуху. Для этого нужно зайти браузером на контроллер по URL вида http://esp-xxxx/update, где xxxx это ID контроллера, нажать на кномпу Firmware, выбрать файл с прошивкой и загрузить его в контроллер.
 Файл с прошивкой Platformio кладет в папку проекта:
  - **.pio/build/stable/firmware.bin** - обычная версия
  - **.pio/build/debug/firmware.bin** - debug версия
  